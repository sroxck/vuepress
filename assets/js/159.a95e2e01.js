(window.webpackJsonp=window.webpackJsonp||[]).push([[159],{727:function(a,t,s){"use strict";s.r(t);var e=s(58),n=Object(e.a)({},(function(){var a=this,t=a.$createElement,s=a._self._c||t;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("blockquote",[s("p",[a._v("Ajax是浏览器提供的一套api, 可以实现页面无刷新更新数据等操作")])]),a._v(" "),s("h3",{attrs:{id:"ajax-应用场景"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ajax-应用场景"}},[a._v("#")]),a._v(" Ajax 应用场景")]),a._v(" "),s("ol",[s("li",[s("p",[a._v("页面上拉更多数据")])]),a._v(" "),s("li",[s("p",[a._v("列表数据无刷新分页")])]),a._v(" "),s("li",[s("p",[a._v("表单项失去焦点数据验证")])]),a._v(" "),s("li",[s("p",[a._v("搜索框提示文字下拉列表")])]),a._v(" "),s("li",[s("p",[a._v("等等等...")])])]),a._v(" "),s("h3",{attrs:{id:"ajax-运行环境"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ajax-运行环境"}},[a._v("#")]),a._v(" Ajax 运行环境")]),a._v(" "),s("blockquote",[s("p",[a._v("Ajax技术需要运行在网站环境中才能生效,用本地文件的方式运行的ajax是无效的(暂不严谨)")])]),a._v(" "),s("h3",{attrs:{id:"ajax-实现方法"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ajax-实现方法"}},[a._v("#")]),a._v(" Ajax 实现方法")]),a._v(" "),s("ol",[s("li",[s("p",[a._v("创建Ajax对象:")]),a._v(" "),s("p",[s("code",[a._v("let xhr =new XMLHttpRequest()")])])]),a._v(" "),s("li",[s("p",[a._v("告诉Ajax请求地址和请求方式:")]),a._v(" "),s("p",[s("code",[a._v("xhr.open('请求方式', '请求地址')")])])]),a._v(" "),s("li",[s("p",[a._v("发送请求:")]),a._v(" "),s("p",[s("code",[a._v("xhr.send()")])])]),a._v(" "),s("li",[s("p",[a._v("获取服务端的响应数据:")]),a._v(" "),s("div",{staticClass:"language-javascript line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[a._v("xhr"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function-variable function"}},[a._v("onload")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("function")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n    console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("xhr"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("responseText"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("// responseText 是服务端响应回来的数据")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br")])]),s("blockquote",[s("p",[a._v("接收到服务端响应后onload会自动触发")])])])]),a._v(" "),s("h3",{attrs:{id:"响应的数据格式-json"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#响应的数据格式-json"}},[a._v("#")]),a._v(" 响应的数据格式:JSON")]),a._v(" "),s("p",[a._v("​\t在项目中,服务端会返回JSON格式的数据,需要将JSON和HTML拼接,展示在页面中,在服务端数据都会被转换为字符串传输,使用JSON.parse解析JSON字符串")]),a._v(" "),s("h3",{attrs:{id:"ajaz-请求参数的传递"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ajaz-请求参数的传递"}},[a._v("#")]),a._v(" Ajaz 请求参数的传递")]),a._v(" "),s("ol",[s("li",[a._v("GET: 在"),s("code",[a._v("xhr.open('get','地址?name='刘德华'&age=18)")]),a._v("中拼接参数")]),a._v(" "),s("li",[a._v("POST: 请求方式必须设置请求内容的类型,在send中设置请求体")])]),a._v(" "),s("div",{staticClass:"language-java line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[a._v("xhr"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("setRequestHeaader")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'content-type'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'application/-x-www-form-urlencoded'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\nxhr"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("send")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("name"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'刘德华'")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("&")]),a._v("age"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("18")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br")])]),s("h3",{attrs:{id:"ajax-请求参数的类型和格式"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ajax-请求参数的类型和格式"}},[a._v("#")]),a._v(" Ajax 请求参数的类型和格式")]),a._v(" "),s("ol",[s("li",[s("code",[a._v("application/-x-www-form-urlencoded")]),a._v(" 例: "),s("code",[a._v("name='刘德华'&age=18")])]),a._v(" "),s("li",[s("code",[a._v("application/json")]),a._v(" JSON先转换为JSON字符串("),s("code",[a._v("JSON.stringify()")]),a._v("),才可以向服务端传输")])]),a._v(" "),s("blockquote",[s("p",[a._v("注意: get请求只能提交1方法, 传统网站的表单也只能用1方法")])]),a._v(" "),s("h3",{attrs:{id:"ajax-状态码"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ajax-状态码"}},[a._v("#")]),a._v(" Ajax 状态码")]),a._v(" "),s("ul",[s("li",[a._v("0: 请求未初始化 (还没调用open)")]),a._v(" "),s("li",[a._v("1: 请求已建立,但没发送 (没调用send)")]),a._v(" "),s("li",[a._v("2: 请求已发送")]),a._v(" "),s("li",[a._v("3: 请求正在处理,下载响应体")]),a._v(" "),s("li",[a._v("4: 响应体接收完毕")])]),a._v(" "),s("blockquote",[s("p",[a._v("xhr.readyState属性获取状态码")]),a._v(" "),s("p",[a._v("xhr.onreadyStateChange事件: 状态码改变后触发的事件")]),a._v(" "),s("p",[a._v("onload事件不兼容IE低版本,需要兼容使用onreadyStateChange事件 判断readyState状态码是否为4即可")])]),a._v(" "),s("h3",{attrs:{id:"ajax-错误处理"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ajax-错误处理"}},[a._v("#")]),a._v(" Ajax 错误处理")]),a._v(" "),s("ol",[s("li",[s("p",[a._v("服务端返回的不是预期结果")]),a._v(" "),s("p",[a._v("判断HTTP状态码进行处理, xhr.status 获取HTTP状态码")])]),a._v(" "),s("li",[s("p",[a._v("服务端没有接收到请求,返回404状态码")]),a._v(" "),s("p",[a._v("检查请求地址")])]),a._v(" "),s("li",[s("p",[a._v("接受到请求,返回500系列状态码")]),a._v(" "),s("p",[a._v("服务端错误,找后端")])]),a._v(" "),s("li",[s("p",[a._v("网络中断,无法发送请求")]),a._v(" "),s("p",[a._v("会触发onerror事件,进行处理")])])]),a._v(" "),s("h3",{attrs:{id:"ajax-ie缓存问题"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ajax-ie缓存问题"}},[a._v("#")]),a._v(" Ajax IE缓存问题")]),a._v(" "),s("p",[a._v("IE低版本中,存在缓存问题,即请求地址不变的情况下,只有第一次发送的ajax请求可以成功,后续发送的请求都会从缓存中获取结果")]),a._v(" "),s("p",[a._v("解决方法:在请求地址后面追加参数,保证每一次请求中的请求参数的值都不同")]),a._v(" "),s("p",[s("code",[a._v("xhr.open('get','http://www.yalibook.com?t=' + Math.random())")])]),a._v(" "),s("h3",{attrs:{id:"ajax-全局事件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ajax-全局事件"}},[a._v("#")]),a._v(" Ajax 全局事件")]),a._v(" "),s("blockquote",[s("p",[a._v("只要有ajax请求,对应的全局事件就会触发,可以用于制作loading等待效果")])]),a._v(" "),s("ol",[s("li",[a._v("ajaxStart() 请求开始时触发")]),a._v(" "),s("li",[a._v("ajaxComplete() 请求完成时触发")])]),a._v(" "),s("h3",{attrs:{id:"ajax-请求限制"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ajax-请求限制"}},[a._v("#")]),a._v(" Ajax 请求限制")]),a._v(" "),s("p",[a._v("Ajax 只能向同源的地址发送请求")])])}),[],!1,null,null,null);t.default=n.exports}}]);